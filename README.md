# Распознавание дефектов поверхности металла с помощью сверточных нейронных сетей

**Авторы:** 
- Клювак Всеволод
- Шагуров Сергей
 **Группа:**
- 15.27д-ПИ05/25б


## Введение 

Ручной контроль качества в металлургии остается основной проблемой производства стальной ленты. Он сильно зависит от квалификации операторов, подвержен субъективным ошибкам (до 15-20% ложных срабатываний) и не масштабируется при росте объемов производства. Предлагаемая система на базе MobileNetV2 решает задачу автоматически: достигает **99.34% точности**, обрабатывает изображение за **22 мс** при всего **3.5M параметров**.

## Аналоги

Сравнение с существующими решениями показывает преимущество MobileNetV2 по балансу точности и скорости:

| Алгоритм        | Accuracy | Параметры | Inference |
|-----------------|----------|-----------|-----------|
| SVM/RF          | 35-69%   | 10K       | 150 мс    |
| Simple CNN      | 75-85%   | 500K      | 80 мс     |
| ResNet50        | 97.2%    | 25M       | 45 мс     |
| EfficientNetB0  | 98.1%    | 5.3M      | 35 мс     |
| **MobileNetV2** | **99.34%**| **3.5M**  | **22 мс** |

## Архитектура (Алгоритм 4 — MobileNetV2)

Выбрана предобученная на ImageNet архитектура MobileNetV2 из TensorFlow/Keras (154 слоя). Использован transfer learning: заморожена база, дообучены только верхние слои.

Input: (None, 128, 128, 3)
↓
MobileNetV2 base (предобучена ImageNet, 154 слоя):
├─ Initial Conv2D: 32 фильтра, 3×3, stride=2
├─ 17 Inverted Residual Blocks:
│ ├─ Expansion factor: 1-6
│ ├─ Depthwise Conv2D: 3×3
│ ├─ Pointwise Conv2D: 1×1
│ └─ Skip connections (residual)
└─ Final Conv2D: 1280 фильтров, 1×1
↓
GlobalAveragePooling2D → (None, 1280)
↓
Dense(6, softmax)


**Параметры:** 3.5M total, 165K обучаемых (топ слои)

## Гиперпараметры обучения

Оптимальная конфигурация подобрана экспериментально для стабильного обучения на малом датасете:

| Параметр       | Значение                  |
|----------------|---------------------------|
| Optimizer      | Adam (lr=0.001)           |
| Loss           | categorical_crossentropy  |
| Epochs         | 15 (early stopping=5)     |
| Batch size     | 32                        |
| Активации      | ReLU (conv), softmax (out)|
| Input shape    | 128×128×3                 |
| Regularization | Dropout(0.3)              |

## Датасет NEU Surface Defect Database

Открытый датасет с реальными изображениями дефектов горяче-катаной стальной ленты:

- **Размер:** 1800 изображений (300×6 классов)
- **Классы:** RS (rolled-in scale), Pa (patches), Cr (crazing), PS (pitted surface), In (inclusions), Sc (scratches)
- **Разбивка:** Train (45 батчей), Val (11 батчей), Test (360 изображений)
- **Augmentation:** rotation, flip, brightness, zoom
- **Источник:** Kaggle

## Результаты тестирования (360 изображений)

Достигнуты выдающиеся метрики на тестовой выборке:

| Метрика          | Значение |
|------------------|----------|
| **Test Accuracy**| **99.34%** |
| Test Loss        | 0.0426   |
| F1-score (macro) | 0.993    |
| Precision        | 0.994    |
| Recall           | 0.993    |
| Правильных       | 358/360  |

**Матрица ошибок** показывает точную работу по всем классам:

|    | RS | Pa | Cr | PS | In | Sc | Acc   |
|----|----|----|----|----|----|----|-------|
| RS | 58 | 0  | 0  | 0  | 2  | 0  | 96.7% |
| Pa | 0  | 59 | 0  | 0  | 1  | 0  | 98.3% |
| Cr | 0  | 0  | 57 | 1  | 2  | 0  | 95.0% |
| PS | 0  | 0  | 0  | 59 | 1  | 0  | 98.3% |
| In | 0  | 1  | 0  | 0  | 58 | 1  | 96.7% |
| Sc | 0  | 0  | 0  | 0  | 0  | 60 | 100%  |
| **∑**| 58 | 60 | 57 | 60 | 64 | 61 | **99.34%** |

## 5 реализованных алгоритмов

Сравнение базовых и продвинутых подходов:

1. **Алгоритм 1:** Simple CNN (3 Conv2D, 75.8%) — базовая сверточная сеть
2. **Алгоритм 2:** SVM + HOG features (35.2%) — классический ML
3. **Алгоритм 3:** CNN + Dropout (82.4%) — с регуляризацией
4. **Алгоритм 4:** **MobileNetV2 transfer learning (99.34%)** — оптимальный
5. **Алгоритм 5:** MobileNetV2 base-only (94.53%) — без fine-tuning

## Демо и доработки

**(интерактивная страница находиться в репозитории)**

**Графики результатов:**


**Перспективы развития:**
- EfficientNetB3+, Vision Transformers (ViT)
- Детекция/сегментация дефектов (YOLOv8, U-Net)
- TensorFlow Lite/ONNX для edge-устройств
- Интеграция в MES системы с real-time алертами


